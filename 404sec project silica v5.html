<!DOCTYPE html>
<html>
<head>
  <title>P2P-projectsilica-404sec</title>
  <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
  <style>
function refreshAvatars() {
  avatarGrid.innerHTML = ""; // Clear current avatars
  for (let i = 0; i < 9; i++) {
    const style = styles[Math.floor(Math.random() * styles.length)];
    const seed = avatarSeed + Math.floor(Math.random() * 10000);
    const img = document.createElement("img");
    img.src = `https://api.dicebear.com/7.x/${style}/svg?seed=${seed}`;
    img.title = `Style: ${style}`;
    img.onclick = () => {
      avatarURL = img.src;
      document.getElementById("avatarPicker").style.display = "none";
      document.getElementById("lockScreen").style.display = "flex";
    };
    avatarGrid.appendChild(img);
  }
}
    body {
      margin: 0;
      font-family: monospace;
      background: #000;
      color: #0f0;
      display: flex;
      flex-direction: column;
      height: 100vh;
      padding: 20px;
    }
    #chatbox {
      flex: 1;
      overflow-y: auto;
      border: 1px solid #0f0;
      padding: 10px;
      background: #111;
      margin-bottom: 10px;
    }
    .message {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
    }
    .avatar {
      width: 40px;
      height: 40px;
      object-fit: cover;
      border: 1px solid #0f0;
      margin-right: 10px;
      border-radius: 4px;
    }
    .text {
      line-height: 1.4;
    }
    input, button {
      background: #111;
      color: #0f0;
      border: 1px solid #0f0;
      padding: 10px;
      font-family: monospace;
    }
    #bottom {
      display: flex;
      gap: 10px;
    }
    #peerArea {
      margin-bottom: 10px;
    }
    #avatarPicker {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.95);
      z-index: 10000;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-family: monospace;
      color: #0f0;
    }
    #avatarGrid {
      display: grid;
      grid-template-columns: repeat(3, 80px);
      gap: 15px;
      margin: 20px 0;
    }
    #avatarGrid img {
      width: 70px;
      border: 1px solid #0f0;
      cursor: pointer;
    }
    .avatar-option {
      margin-top: 10px;
    }
  </style>
</head>
<body oncontextmenu="return false;">

 <!-- Avatar Picker -->
<div id="avatarPicker">
  <h3>üßô Choose Your Avatar</h3>
  
  <div class="avatar-option">
    <button onclick="refreshAvatars()">üîÑ Refresh Avatars</button>
  </div>

  <div id="avatarGrid"></div>

  <div class="avatar-option">
    <button onclick="useBlackAvatar()">Use Black Avatar</button>
  </div>

  <div class="avatar-option">
    <input type="text" id="customURL" placeholder="Your image URL..." style="width: 200px;" />
    <button onclick="useCustomURL()">Use Custom URL</button>
  </div>

  <p style="font-size: 12px;">Generated avatars by Dicebear | You can also use your own image</p>
</div>
  <!-- Password Lock Screen (hidden initially) -->
  <div id="lockScreen" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: #000; z-index: 9999; display: flex; flex-direction: column;
    align-items: center; justify-content: center; color: #0f0; font-family: monospace;">
    <h2>üîê Enter Password to Access Chat</h2>
    <form id="unlockForm">
      <input type="password" id="passwordInput" placeholder="Password..." required autocomplete="off" />
      <button type="submit">Unlock</button>
    </form>
    <p id="passwordMsg" style="margin-top:10px; color:red;"></p>
  </div>

  <!--credits: untied , o2 , BR.MKS.EDITS , hd-->
  <h2>‚ö° project silica 404sec</h2>

  <div id="peerArea">
    <p>Your ID: <span id="my-id">...</span></p>
    <input id="connectId" placeholder="Enter friend's ID to connect" />
    <button onclick="connectToPeer()">Connect</button>
  </div>

  <div id="chatbox"></div>

  <div id="bottom">
    <input id="messageInput" placeholder="Type message..." />
    <button onclick="sendMessage()">Send</button>
  </div>

  <script>
    let username = prompt("Choose your username:") || "Anonymous";
    let avatarURL = "";

    const styles = ["fun-emoji", "pixel-art", "bottts", "identicon", "adventurer", "croodles"];
    const avatarSeed = username.replace(/\W+/g, '').toLowerCase() || "guest";
    const avatarGrid = document.getElementById("avatarGrid");

    for (let i = 0; i < 9; i++) {
      const style = styles[Math.floor(Math.random() * styles.length)];
      const seed = avatarSeed + Math.floor(Math.random() * 1000);
      const img = document.createElement("img");
      img.src = `https://api.dicebear.com/7.x/${style}/svg?seed=${seed}`;
      img.title = `Style: ${style}`;
      img.onclick = () => {
        avatarURL = img.src;
        document.getElementById("avatarPicker").style.display = "none";
        document.getElementById("lockScreen").style.display = "flex";
      };
      avatarGrid.appendChild(img);
    }

    function useBlackAvatar() {
      avatarURL = "https://via.placeholder.com/40x40/000/000";
      document.getElementById("avatarPicker").style.display = "none";
      document.getElementById("lockScreen").style.display = "flex";
    }

    function useCustomURL() {
      const url = document.getElementById("customURL").value.trim();
      if (url) {
        avatarURL = url;
        document.getElementById("avatarPicker").style.display = "none";
        document.getElementById("lockScreen").style.display = "flex";
      }
    }

    document.getElementById('unlockForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const pw = document.getElementById('passwordInput').value;
      const msg = document.getElementById('passwordMsg');
      if (pw === ':)00@') {
        document.getElementById('lockScreen').style.display = 'none';
      } else {
        msg.textContent = '‚ùå Incorrect password.';
      }
    });

    const peer = new Peer();
    let conn = null;

    document.getElementById('my-id').textContent = '...';
    peer.on('open', id => {
      document.getElementById('my-id').textContent = id;
    });

    peer.on('connection', connection => {
      conn = connection;
      conn.on('data', renderIncomingMessage);
      appendSystemMsg("‚úÖ Incoming connection established");
    });

    function connectToPeer() {
      const friendId = document.getElementById('connectId').value.trim();
      if (!friendId) return;
      conn = peer.connect(friendId);
      conn.on('open', () => {
        appendSystemMsg("‚úÖ Connected to peer");
        conn.on('data', renderIncomingMessage);
      });
    }

    function sendMessage() {
      const input = document.getElementById('messageInput');
      const msg = input.value.trim();
      if (!msg || !conn || !conn.open) return;

      const payload = {
        user: username,
        avatar: avatarURL,
        text: msg
      };

      appendMessage(payload, true);
      conn.send(payload);
      input.value = '';
    }

    function renderIncomingMessage(data) {
      appendMessage(data, false);
    }

    function appendMessage(data, isYou) {
      const div = document.createElement('div');
      div.className = 'message';

      const avatar = document.createElement('img');
      avatar.className = 'avatar';
      avatar.src = data.avatar;

      const text = document.createElement('div');
      text.className = 'text';
      text.innerHTML = `<strong>${isYou ? "You" : data.user}</strong>: ${data.text}`;

      div.appendChild(avatar);
      div.appendChild(text);
      document.getElementById('chatbox').appendChild(div);
      document.getElementById('chatbox').scrollTop = chatbox.scrollHeight;
    }

    function appendSystemMsg(msg) {
      const div = document.createElement('div');
      div.className = 'text';
      div.textContent = msg;
      document.getElementById('chatbox').appendChild(div);
    }
  </script>

</body>
</html>