<!-- untiedlaces , o2 3 , bxr , hd -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>‚ö° project silica 404sec (Quick + Manual Connect)</title>
  <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0 }
    body {
      background: #000; color: #0f0;
      font-family: monospace; display: flex;
      flex-direction: column; height: 100vh;
      padding: 20px;
    }
    h2 { margin-bottom: 12px }
    input, button, select {
      background: #111; color: #0f0;
      border: 1px solid #0f0; padding: 6px 10px;
      font-family: monospace; font-size: 1em;
    }
    button:disabled { opacity: 0.4; cursor: not-allowed }
    /* Avatar Picker & Lock */
    #avatarPicker, #lockScreen {
      position: fixed; inset: 0; display: none;
      background: rgba(0,0,0,0.95);
      flex-direction: column; align-items: center;
      justify-content: center; z-index: 1000;
    }
    #avatarPicker.active, #lockScreen.active { display: flex }
    #avatarGrid {
      display: grid; grid-template-columns: repeat(3,80px);
      gap: 12px; margin: 16px 0;
    }
    #avatarGrid img {
      width: 70px; cursor: pointer;
      border: 1px solid #0f0; border-radius: 4px;
    }
    .avatar-option { margin-top: 10px }
    /* Layout Groups */
    #peerArea, #quickConnect, #manualConnect,
    #connections, #chatbox, #bottom {
      margin-bottom: 12px;
    }
    #quickConnect button { margin-right: 6px; }
    #connections .conn-item {
      display: flex; justify-content: space-between;
      padding: 4px; border: 1px solid #0f0;
      margin-top: 4px;
    }
    #chatbox {
      flex: 1; overflow-y: auto;
      background: #111; border: 1px solid #0f0;
      padding: 10px;
    }
    .message {
      display: flex; align-items: center;
      margin-bottom: 8px;
    }
    .avatar-thumb {
      width: 32px; height: 32px;
      object-fit: cover; border: 1px solid #0f0;
      border-radius: 4px; margin-right: 8px;
    }
    .text { line-height: 1.2 }
    .system { opacity: 0.6; font-style: italic }
  </style>
</head>
<body oncontextmenu="return false;">

  <!-- untiedlaces , 02 3 , bxr ,hd -->

  <!-- Avatar Picker -->
  <div id="avatarPicker" class="active">
    <h3>üßô Choose Your Avatar</h3>
    <button onclick="refreshAvatars()">üîÑ Refresh</button>
    <div id="avatarGrid"></div>
    <div class="avatar-option">
      <button onclick="chooseAvatar('https://via.placeholder.com/40/000')">
        Use Black Avatar
      </button>
    </div>
    <div class="avatar-option">
      <input id="customURL" placeholder="Custom URL" />
      <button onclick="useCustomURL()">OK</button>
    </div>
    <p style="font-size:12px;">Avatars by Dicebear | Or supply your own URL</p>
  </div>

  <!-- Lock Screen -->
  <div id="lockScreen">
    <h2>üîê Enter Password</h2>
    <form id="unlockForm">
      <input type="password" id="passwordInput"
             placeholder="Password" required autocomplete="off" />
      <button type="submit">Unlock</button>
    </form>
    <p id="passwordMsg" style="color:red; margin-top:8px;"></p>
  </div>

  <h2>‚ö° project silica 404sec</h2>

  <!-- Peer Info & Copy -->
  <div id="peerArea">
    Your ID: <input id="my-id" readonly size="20" />
    <button id="copyIdBtn">Copy ID</button>
  </div>

  <!-- Quick-Connect Buttons -->
  <div id="quickConnect">
    <strong>Quick Connect:</strong>
  </div>

  <!-- Manual Friend-ID Connect -->
  <div id="manualConnect">
    <input id="friendId" placeholder="Enter Friend ID‚Ä¶" size="20" />
    <button onclick="connectManual()">Connect</button>
  </div>

  <!-- Active Connections List -->
  <div id="connections">
    <strong>Active Peers:</strong>
  </div>

  <!-- Chat Display -->
  <div id="chatbox"></div>

  <!-- Send Message -->
  <div id="bottom">
    <input id="messageInput" placeholder="Type message‚Ä¶" size="40" />
    <button id="sendBtn" disabled>Send</button>
  </div>

  <script>
  (function(){
    // Permanent IDs for quick-connect
    const QUICK_IDS = ['peer-A','peer-B','peer-C','peer-D','peer-E'];

    // Avatar & Lock setup
    let avatarURL = '';
    const username = prompt("Choose your username:") || "Anonymous";
    const styles = ["fun-emoji","pixel-art","bottts","identicon","adventurer","croodles"];
    const seedBase = username.replace(/\W+/g,'').toLowerCase()||'guest';
    const grid = document.getElementById('avatarGrid');

    function refreshAvatars(){
      grid.innerHTML = '';
      for(let i=0;i<9;i++){
        const style = styles[Math.floor(Math.random()*styles.length)];
        const seed = seedBase + Math.floor(Math.random()*10000);
        const img = document.createElement('img');
        img.src = `https://api.dicebear.com/7.x/${style}/svg?seed=${seed}`;
        img.onclick = ()=> chooseAvatar(img.src);
        grid.appendChild(img);
      }
    }
    function chooseAvatar(url){
      avatarURL = url;
      document.getElementById('avatarPicker').classList.remove('active');
      document.getElementById('lockScreen').classList.add('active');
    }
    function useCustomURL(){
      const url = document.getElementById('customURL').value.trim();
      if(url) chooseAvatar(url);
    }
    refreshAvatars();

    // Unlock form
    document.getElementById('unlockForm').addEventListener('submit', e=>{
      e.preventDefault();
      if (document.getElementById('passwordInput').value === ':)00@') {
        document.getElementById('lockScreen').classList.remove('active');
      } else {
        document.getElementById('passwordMsg').textContent = '‚ùå Incorrect';
      }
    });

    // PeerJS setup
    const peer = new Peer(), connections = {};
    const idInput = document.getElementById('my-id');
    const connDiv = document.getElementById('connections');
    const sendBtn = document.getElementById('sendBtn');

    peer.on('open', id => {
      idInput.value = id;
    });
    peer.on('connection', c => {
      if (!connections[c.peer]) setupConnection(c);
    });

    // Copy own ID
    document.getElementById('copyIdBtn').onclick = ()=>{
      navigator.clipboard.writeText(idInput.value)
        .then(()=> alert('ID copied'));
    };

    // Quick-connect buttons
    const qcDiv = document.getElementById('quickConnect');
    QUICK_IDS.forEach(fid => {
      const btn = document.createElement('button');
      btn.textContent = fid;
      btn.onclick = ()=> connectPeer(fid);
      qcDiv.appendChild(btn);
    });

    // Manual connect
    window.connectManual = ()=>{
      const fid = document.getElementById('friendId').value.trim();
      connectPeer(fid);
    };

    function connectPeer(peerId){
      if (!peerId || peerId === peer.id || connections[peerId]) return;
      const c = peer.connect(peerId);
      c.on('open', ()=> setupConnection(c));
    }

    // Connection handler
    function setupConnection(c){
      connections[c.peer] = c;
      renderConnections();
      appendSystemMsg(`‚úÖ Connected to ${c.peer}`);
      c.on('data', data => appendMessage(data, false));
      c.on('close', ()=>{
        delete connections[c.peer];
        appendSystemMsg(`‚ùå ${c.peer} disconnected`);
        renderConnections();
      });
    }

    function renderConnections(){
      connDiv.innerHTML = '<strong>Active Peers:</strong>';
      const list = Object.keys(connections);
      if (!list.length) {
        connDiv.innerHTML += ' <span class="system">none</span>';
      }
      list.forEach(id => {
        const item = document.createElement('div');
        item.className = 'conn-item';
        item.innerHTML = `
          <span>${id}</span>
          <button onclick="disconnect('${id}')">‚úñ</button>
        `;
        connDiv.appendChild(item);
      });
      sendBtn.disabled = list.length === 0;
    }

    window.disconnect = id => {
      connections[id].close();
      delete connections[id];
      renderConnections();
      appendSystemMsg(`‚ùå You disconnected ${id}`);
    };

    // Chat send
    sendBtn.onclick = ()=>{
      const input = document.getElementById('messageInput');
      const text = input.value.trim();
      if (!text) return;
      const msg = { user: username, avatar: avatarURL, text };
      appendMessage(msg, true);
      Object.values(connections).forEach(c=> c.open && c.send(msg));
      input.value = '';
    };

    function appendMessage({user,avatar,text}, isYou){
      const div = document.createElement('div');
      div.className = 'message';
      div.innerHTML = `
        <img class="avatar-thumb" src="${avatar}" />
        <div class="text">
          <strong>${isYou?'You':user}:</strong> ${text}
        </div>
      `;
      document.getElementById('chatbox').appendChild(div);
      chatbox.scrollTop = chatbox.scrollHeight;
    }

    function appendSystemMsg(msg){
      const div = document.createElement('div');
      div.className = 'text system';
      div.textContent = msg;
      document.getElementById('chatbox').appendChild(div);
      chatbox.scrollTop = chatbox.scrollHeight;
    }
  })();
  </script>
</body>
</html>
